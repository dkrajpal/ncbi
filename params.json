{"name":"ncbi","tagline":"Search and retrieve data from the NCBI databases.","body":"\r\n\r\n\r\n# ncbi\r\n\r\n`ncbi` allows to search, download and parse data records from various NCBI\r\ndatabases. \r\n\r\nThis package builds on the interface to the NCBI Entrez facilities provided\r\nby the package [rentrez](https://github.com/gschofl/rentrez) but attempts to\r\nparse the retrieved XML or text records into native R objects.\r\n\r\nSequences in fasta format are returned as `AAStringSet` or `DNAStringSet`\r\nobjects. GenBank flat files are returned as `gbRecord`\r\nobjects (Package [biofiles](https://github.com/gschofl/biofiles)). Taxon\r\nrecords are returned as `taxon` or `taxonList` objects, PubMed records are returned as `pubmed` objects.\r\n\r\nCurrently implemented are functions for the sequence databases _protein_,\r\n_nuccore_, _nucgss_, and _nucest_, as well as for _pubmed_ and _taxonomy_.\r\n\r\n### Installation\r\n\r\nThis package is currently only available via github. It depends on a number\r\nof utility functions provided in my [rmisc](https://github.com/gschofl/rmisc) package. Use Hadley Wickham's [devtools](https://github.com/hadley/devtools)\r\nto install:\r\n\r\n`ncbi` depends on functionality provided by packages\r\ncurrently not available from CRAN:\r\n[rentrez](https://github.com/gschofl/rentrez),\r\n[biofiles](https://github.com/gschofl/biofiles), and\r\n[rmisc](https://github.com/gschofl/rmisc).\r\n\r\nUse Hadley Wickham's [devtools](https://github.com/hadley/devtools) to \r\ninstall:\r\n\r\n\r\n\r\n```r\r\nrequire(devtools)\r\ninstall_github(\"rmisc\", \"gschofl\")\r\ninstall_github(\"rentrez\", \"gschofl\")\r\ninstall_github(\"biofiles\", \"gschofl\")\r\ninstall_github(\"ncbi\", \"gschofl\")\r\n```\r\n\r\n\r\n\r\n\r\n### Important functions\r\n\r\n#### `protein`, `nucleotide`, `EST`, and `GSS`\r\n\r\n\r\n#### `parseTSeqSet`, and `parseGenBank`\r\n\r\n\r\n#### `pubmed`, `parsePubmed`, and `browsePubmed`\r\n\r\n\r\n#### `taxon` and `parseTaxon`\r\n\r\n\r\n### Examples\r\n\r\n#### Retrieving protein sequences for _Chlamydia psittaci_ 6BC:\r\n\r\nLet's first retrieve the accession numbers for all proteins for _C. psittaci_\r\n6BC. As a default `retmax` is set to 100. To get all accession numbers we set\r\n`retmax = NULL` and `rettype='acc'`.\r\n\r\n\r\n```r\r\npsit_acc <- protein(\"Chlamydia psittaci 6BC[ORGN]\", rettype = \"acc\", retmax = NULL)\r\npsit_acc\r\n\r\n ##    [1] \"Q46203.1\"       \"F0T4D1.1\"       \"Q46225.1\"       \"F0T376.1\"      \r\n ##    [5] \"YP_005663703.1\" \"YP_005663701.1\" \"YP_005663699.1\" \"YP_005663704.1\"\r\n ##    [9] \"YP_005663702.1\" \"YP_005663700.1\" \"YP_005663698.1\" \"YP_005663696.1\"\r\n ##   [13] \"YP_005663694.1\" \"YP_005663692.1\" \"YP_005663690.1\" \"YP_005663688.1\"\r\n....\r\n```\r\n\r\n\r\n\r\n\r\nDownload the first 10 proteins. The default retrieval type is `fasta` and gets\r\nparsed into an `AAStringSet` or `DNAStringSet`. Parsing can be turned of\r\nby setting the attribute `parse = FALSE`. \r\n\r\n\r\n```r\r\npsit_seq <- protein(psit_acc[1:10])\r\npsit_seq\r\n\r\n ##    A AAStringSet instance of length 10\r\n ##       width seq                                         names               \r\n ##   [1]   402 MKKLLKSALLFAATGSALSL...TGEARLINERAAHMNAQFRF Q46203.1 RecName:...\r\n ##   [2]   433 MIKGRRTKLHTFLYDCFLIF...KVAFDRTWESFKRYIPCVKI F0T4D1.1 RecName:...\r\n....\r\n```\r\n\r\n\r\n\r\n\r\n\r\n\r\n```r\r\nprotein(psit_acc[1:10], parse = FALSE)\r\n\r\n ##  <?xml version=\"1.0\"?>\r\n ##  <!DOCTYPE TSeqSet PUBLIC \"-//NCBI//NCBI TSeq/EN\" \"http://www.ncbi.nlm.nih.gov/dtd/NCBI_TSeq.dtd\">\r\n ##  <TSeqSet>\r\n ##    <TSeq>\r\n ##      <TSeq_seqtype value=\"protein\"/>\r\n ##      <TSeq_gi>75428263</TSeq_gi>\r\n ##      <TSeq_accver>Q46203.1</TSeq_accver>\r\n ##      <TSeq_taxid>331636</TSeq_taxid>\r\n....\r\n```\r\n\r\n\r\n\r\n\r\nLook at the metadata that comes with the sequences\r\n\r\n\r\n```r\r\nrequire(Biostrings)\r\nnames(elementMetadata(psit_seq))\r\n\r\n ##  [1] \"gi\"      \"accver\"  \"sid\"     \"local\"   \"taxid\"   \"orgname\" \"defline\"\r\n ##  [8] \"length\"\r\n```\r\n\r\n\r\n\r\n\r\n\r\n\r\n```r\r\nelementMetadata(psit_seq)[[\"defline\"]]\r\n\r\n ##   [1] \"RecName: Full=Major outer membrane porin; Short=MOMP; Flags: Precursor\"                                                                                                                                                                                  \r\n ##   [2] \"RecName: Full=3-deoxy-D-manno-octulosonic acid transferase; Short=Kdo transferase; AltName: Full=Kdo(2)-lipid IV(A) 3-deoxy-D-manno-octulosonic acid transferase; AltName: Full=Kdo(3)-lipid IV(A) 3-deoxy-D-manno-octulosonic acid transferase; AltNam>\"\r\n ##   [3] \"RecName: Full=2-dehydro-3-deoxyphosphooctonate aldolase; AltName: Full=3-deoxy-D-manno-octulosonic acid 8-phosphate synthase; AltName: Full=KDO-8-phosphate synthase; Short=KDO 8-P synthase; Short=KDOPS; AltName: Full=Phospho-2-dehydro-3-deoxyocton>\"\r\n ##   [4] \"RecName: Full=Small cysteine-rich outer membrane protein omcA; Short=Small-CRP; AltName: Full=9 kDa cysteine-rich lipoprotein; Short=9KD-CRP; Flags: Precursor\"                                                                                          \r\n ##   [5] \"replicative DNA helicase [Chlamydophila psittaci 6BC]\"                                                                                                                                                                                                   \r\n ##   [6] \"hypothetical protein G5O_p0004 [Chlamydophila psittaci 6BC]\"                                                                                                                                                                                             \r\n ##   [7] \"hypothetical protein G5O_p0002 [Chlamydophila psittaci 6BC]\"                                                                                                                                                                                             \r\n ##   [8] \"site-specific recombinase, phage integrase family [Chlamydophila psittaci 6BC]\"                                                                                                                                                                          \r\n ##   [9] \"hypothetical protein G5O_p0005 [Chlamydophila psittaci 6BC]\"                                                                                                                                                                                             \r\n ##  [10] \"sporulation initiation inhibitor protein soj [Chlamydophila psittaci 6BC]\"\r\n....\r\n```\r\n\r\n\r\n\r\n\r\nFetch the full Genbank entry for a protein\r\n\r\n\r\n```r\r\ngi5 <- elementMetadata(psit_seq)[[\"gi\"]][5]\r\np <- protein(gi5, \"gp\")\r\n\r\n ##  Parsing features into \"file7a619c5daf2.db\"\r\nr\r\np\r\n\r\n ##  'gbRecord' database 'file7a619c5daf2.db' with 10 features\r\n ##  LOCUS       YP_005663703 458 aa AA linear BCT 27-SEP-2012\r\n ##  DEFINITION  replicative DNA helicase [Chlamydophila psittaci 6BC].\r\n ##  ACCESSION   YP_005663703\r\n ##  VERSION     YP_005663703.1 GI:384451104\r\n ##  DBLINK      Project: 159845\r\n ##  DBSOURCE    REFSEQ: accession NC_017288.1\r\n ##  KEYWORDS    .\r\n ##  SOURCE      Chlamydophila psittaci 6BC (Chlamydia psittaci 6BC)\r\n ##    ORGANISM  Chlamydophila psittaci 6BC\r\n ##              Bacteria; Chlamydiae; Chlamydiales; Chlamydiaceae;\r\n ##               Chlamydia/Chlamydophila group; Chlamydia.\r\n ##  REFERENCE   Not implemented yet\r\n ##  COMMENT     PROVISIONAL REFSEQ: This record has not yet been subject\r\n ##               to final NCBI review. The reference sequence is identical\r\n ##               to AEB56030. Method: conceptual translation.\r\n ##  ORIGIN      mikqseeekdlldveffvlgqavnylehahvvvrrlsehhfksenhknifllirdilrdrd\r\n ##               ...\r\n ##               gqieqdadvilflhrkdyysqeatkglseiivgknrhgsvfsttlrfnsctgkftiqkeaw\r\n```\r\n\r\n\r\n\r\n\r\n\r\n\r\n```r\r\nrequire(biofiles)\r\nfeatures(p)\r\n\r\n ##  'gbFeatureList' with 10 features:\r\n ##  \r\n ##  Feature:         Location/Qualifiers:\r\n ##   source          1..458\r\n ##                   /organism=\"Chlamydophila psittaci 6BC\"\r\n ##                   /strain=\"6BC\"\r\n ##                   /culture_collection=\"ATCC:VR-125\"\r\n ##                   /db_xref=\"taxon:331636\"\r\n ##                   /plasmid=\"pCps6BC\"\r\n ##  \r\n....\r\n```\r\n\r\n\r\n\r\n\r\n#### Retrieving taxon information for Chlamydiaceae:\r\n\r\nWhich taxa within the family _Chlamydiaceae_ are on NCBI\r\n\r\n\r\n```r\r\ntx <- taxon(\"Chlamydiaceae[subtree]\", \"uilist\", retmax = NULL)\r\nlength(tx)\r\n\r\n ##  [1] 254\r\nr\r\nhead(tx, 10)\r\n\r\n ##   [1] 1283074 1282969 1282882 1282662 1282442 1260223 1260222 1238237\r\n ##   [9] 1238236 1238235\r\n```\r\n\r\n\r\n\r\n\r\nDownload all taxon records\r\n\r\n\r\n```r\r\ntxlist <- taxon(\"Chlamydiaceae[subtree]\", retmax = NULL)\r\ntxlist\r\n\r\n ##  A 'taxonList' instance of length 254\r\n ##  Chlamydia psittaci FalTex (1283074; no rank) \r\n ##  Chlamydia psittaci 6BC/83 (1282969; no rank) \r\n ##  Chlamydia psittaci CT1 (1282882; no rank) \r\n ##  Chlamydia psittaci str. Borg (1282662; no rank) \r\n ##  Chlamydia psittaci RTH (1282442; no rank) \r\n ##  Chlamydia trachomatis IU888 (1260223; no rank) \r\n ##  Chlamydia trachomatis IU824 (1260222; no rank) \r\n ##  Chlamydia psittaci 10_1398_11 (1238237; no rank) \r\n ##  Chlamydia psittaci 10_743_SC13 (1238236; no rank) \r\n....\r\n```\r\n\r\n\r\n\r\n\r\nThe scientific names of all those recognized as species\r\n\r\n\r\n```r\r\nsciName(txlist)[taxRank(txlist) == \"species\"]\r\n\r\n ##   [1] \"Chlamydia sp. 10DC88\"                 \r\n ##   [2] \"Chlamydia sp. 12DC97\"                 \r\n ##   [3] \"Chlamydia sp. 12DC96\"                 \r\n ##   [4] \"Chlamydia sp. PV_7344/2\"              \r\n ##   [5] \"Chlamydia sp. PV_7341/13\"             \r\n ##   [6] \"Chlamydia sp. PV_58394/2012\"          \r\n ##   [7] \"Chlamydia sp. PV_48558/2010\"          \r\n ##   [8] \"Chlamydia sp. PV_3954/22\"             \r\n ##   [9] \"Chlamydia sp. PV_3515/3\"              \r\n ##  [10] \"Chlamydia sp. PV_2863/2\"              \r\n....\r\n```\r\n\r\n\r\n\r\n\r\n#### Retrieving data from Pubmed:\r\n\r\nFirst we search PubMed for all publications with _Chlamydia psittaci_ in the\r\ntitle from 2010 to 2012. We use the `esearch` function from [rentrez](https://github.com/gschofl/rentrez) for greater control over the search.\r\n\r\n\r\n```r\r\nrequire(rentrez)\r\npmid <- esearch(\"Chlamydia psittaci[TITL] and \", \"pubmed\", mindate = 2010, maxdate = 2012)\r\npmid\r\n\r\n ##  ESearch query using the 'pubmed' database.\r\n ##  Query term: 'Chlamydia psittaci[TITL] AND 2010[EDAT] : 2012[EDAT]'\r\n ##  Total number of hits: 24\r\n ##  Number of hits retrieved: 24\r\n ##   [1] \"23265868\" \"23227890\" \"23209198\" \"23189195\" \"23098816\" \"22957128\"\r\n ##   [7] \"22689815\" \"22506068\" \"22472082\" \"22382892\" \"22302240\" \"22299031\"\r\n ##  [13] \"22296995\" \"21921110\" \"21885218\" \"21846923\" \"21791668\" \"21761223\"\r\n ##  [19] \"21622741\" \"21393457\" \"21173126\" \"21152037\" \"20807089\" \"22802266\"\r\n```\r\n\r\n\r\n\r\n\r\nNow we fetch the first 5 of these records from PubMed. We can extract the \r\nPMIDs from the `esearch` object using the function `idList` and pass them to\r\n`pubmed` or, more conveniently, simply pass on the subsetted `esearch object.\r\n\r\n\r\n```r\r\nids <- idList(pmid)\r\nids[1:5]\r\n\r\n ##  [1] \"23265868\" \"23227890\" \"23209198\" \"23189195\" \"23098816\"\r\nr\r\np <- pubmed(pmid[1:5])\r\np\r\n\r\n ##  A 'pubmed' instance of length 5\r\n ##  [1] Pmid: 23265868\tReferences: 1\r\n ##  -------------------------------------------------------------------\r\n ##  Ostermann C, Schroedl W, Schubert E, Sachse K and Reinhold P\r\n ##  (2012). \"Dose-dependent effects of Chlamydia psittaci infection on\r\n ##  pulmonary gas exchange, innate immunity and acute-phase reaction\r\n ##  in a bovine respiratory model.\" _Veterinary journal (London,\r\n ##  England : 1997)_. ISSN 1532-2971, <URL:\r\n ##  http://dx.doi.org/10.1016/j.tvjl.2012.10.035>.\r\n ##  \r\n ##  [2] Pmid: 23227890\tReferences: 1\r\n ##  -------------------------------------------------------------------\r\n ##  Gartrell B, French N, Howe L, Nelson N, Houston M, Burrows E,\r\n ##  Russell J and Anderson S (2012). \"First detection of Chlamydia\r\n ##  psittaci from a wild native passerine bird in New Zealand.\" _New\r\n ##  Zealand veterinary journal_. ISSN 0048-0169, <URL:\r\n ##  http://dx.doi.org/10.1080/00480169.2012.740656>.\r\n ##  \r\n....\r\n```\r\n\r\n\r\n\r\n\r\nWhich journals where they published in?\r\n\r\n\r\n```r\r\njournal(p)\r\n\r\n ##  [[1]]\r\n ##  [1] \"Veterinary journal (London, England : 1997)\"\r\n ##  attr(,\"abbrev\")\r\n ##  [1] \"Vet. J.\"\r\n ##  attr(,\"issn\")\r\n ##  [1] \"1532-2971\"\r\n ##  \r\n ##  [[2]]\r\n ##  [1] \"New Zealand veterinary journal\"\r\n ##  attr(,\"abbrev\")\r\n ##  [1] \"N Z Vet J\"\r\n ##  attr(,\"issn\")\r\n....\r\n```\r\n\r\n\r\n\r\n\r\nWhich are the authors?\r\n\r\n\r\n```r\r\nauthor(p)\r\n\r\n ##  [[1]]\r\n ##  [1] \"Carola Ostermann\" \"Wieland Schroedl\" \"Evelyn Schubert\" \r\n ##  [4] \"Konrad Sachse\"    \"Petra Reinhold\"  \r\n ##  \r\n ##  [[2]]\r\n ##  [1] \"Bd Gartrell\" \"Np French\"   \"L Howe\"      \"Nj Nelson\"   \"M Houston\"  \r\n ##  [6] \"Ea Burrows\"  \"Jc Russell\"  \"Sh Anderson\"\r\n ##  \r\n ##  [[3]]\r\n ##  [1] \"Sarah Van Lent\"         \"Jurgen R Piet\"         \r\n ##  [3] \"Delphine Beeckman\"      \"Arie van der Ende\"     \r\n ##  [5] \"Filip Van Nieuwerburgh\" \"Patrik Bavoil\"         \r\n....\r\n```\r\n\r\n\r\n\r\n\r\nAnd finally which are the DOIs?\r\n\r\n\r\n```r\r\ndoi(p)\r\n\r\n ##   [1] doi:10.1016/j.tvjl.2012.10.035\r\n ##   [2] doi:10.1080/00480169.2012.740656\r\n ##   [3] doi:10.1128/JB.01828-12\r\n ##   [4] doi:10.1371/journal.pone.0050327\r\n ##   [5] doi:10.1016/j.vetmic.2012.09.026\r\n```\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}